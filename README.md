# ๐ ุชูุซูู API ุงูุฏูุน ูุชุณุฌูู ุงูุทูุจุงุช (Stripe Checkout)

---

## ๐ฆ ููุงุท ุงูููุงูุฉ (Endpoints)

---

### โ 1. ุฅูุดุงุก ุฌูุณุฉ ุฏูุน ูุชุณุฌูู ุงูุทูุจ

`POST /api/stripe/create-checkout-session`

---

### ๐ง ุงูุจูุงูุงุช ุงููุทููุจุฉ (Body):

```json
{
  "cartItems": [
    {
      "productId": "ูุนุฑูู ุงูููุชุฌ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช",
      "quantity": 2
    },
    {
      "productId": "ูุนุฑูู ููุชุฌ ุขุฎุฑ",
      "quantity": 1
    }
  ],
  "userId": "ูุนุฑูู ุงููุณุชุฎุฏู"
}
```

---

### ๐ ุงูุฑุฏ (Response):

```json
{
  "url": "ุฑุงุจุท ุงูุฏูุน ูู Stripe"
}
```

---

### ๐ ุดุฑุญ ุงููุธููุฉ:

* ุงูุณูุฑูุฑ ูุชุญูู ูู ุงูููุชุฌุงุช ูุงูุฃุณุนุงุฑ.
* ูุชู ุชุณุฌูู ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุญุงูุฉ "ูู ุงูุชุธุงุฑ ุงูุฏูุน".
* ูุชู ุฅูุดุงุก ุฌูุณุฉ ุฏูุน ูู ุฎูุงู Stripe.
* ูุชู ุฅุฑุฌุงุน ุฑุงุจุท ุงูุฏูุน ูููุฑููุช.

---

---

### โ 2. ุฌูุจ ุจูุงูุงุช ุฌูุณุฉ ุงูุฏูุน ุจุนุฏ ุงูุฑุฌูุน ูู Stripe

`GET /api/stripe/session/:sessionId`

---

### ๐ฅ ุงููุทููุจ:

* ุชุจุนุช ูุน ุงูุทูุจ `sessionId` ุงููู Stripe ุจูุฑุฌุนู ูู ุฑุงุจุท ุงููุฌุงุญ ุจุนุฏ ุฅุชูุงู ุงูุฏูุน.

---

### ๐ ุงูุฑุฏ (Response):

```json
{
  "amountPaid": 2000,
  "currency": "usd",
  "paymentStatus": "paid",
  "customerName": "ุงุณู ุงูุนููู",
  "customerEmail": "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู",
  "orderId": "ูุนุฑูู ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"
}
```

---

### ๐ ุดุฑุญ ุงููุธููุฉ:

* ูุชู ุงุณุชุฑุฌุงุน ุจูุงูุงุช ุฌูุณุฉ ุงูุฏูุน ูู Stripe.
* ุชูุนุฑุถ ูุนูููุงุช ุงูุฏูุน ููุนููู ูุซู ุงููุจูุบุ ุญุงูุฉ ุงูุฏูุนุ ุจูุงูุงุช ุงูุนูููุ ูุฑูู ุงูุทูุจ.

---

---

## ๐ก๏ธ ููุงุญุธุงุช ุงูุฃูุงู:

โ๏ธ ูุง ูุฌุจ ุนูู ุงููุฑููุช ุฅุฑุณุงู ุฃุณุนุงุฑ ุงูููุชุฌุงุชุ ุงูุณูุฑูุฑ ูู ุงููุณุคูู ุนู ุงูุชุญูู ูููุง.

โ๏ธ ุงูุทูุจ ููุณุฌู ุฃููุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูููุฑุจุท ุจุฌูุณุฉ Stripe ุชููุงุฆูุงู ุนุจุฑ ุงูู `metadata`.

โ๏ธ ุงูุฃุณุนุงุฑ ุชูุญุณุจ ุจุงููุงูู ูู ุงูุจุงููุฏ ูุญูุงูุฉ ุงููุธุงู ูู ุงูุชูุงุนุจ.

---

---

## ๐งโ๐ป ูุซุงู ุนููู ูููุฑููุช (ุจุงุณุชุฎุฏุงู Fetch):

```js
const res = await fetch('/api/stripe/create-checkout-session', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    cartItems: [
      { productId: "ูุนุฑูู ููุชุฌ", quantity: 2 },
      { productId: "ูุนุฑูู ููุชุฌ ุขุฎุฑ", quantity: 1 }
    ],
    userId: "ูุนุฑูู ุงููุณุชุฎุฏู"
  })
});

const data = await res.json();
window.location.href = data.url;
```

---

---

## โ๏ธ ุชูุจููุงุช ุฅุถุงููุฉ:

* ูุฌุจ ุงูุชูุงุท `session_id` ูู ุฑุงุจุท ุงููุฌุงุญ ุจุนุฏ ุงูุฏูุนุ ูุงุณุชุฎุฏุงูู ูุฌูุจ ุชูุงุตูู ุงูุฌูุณุฉ.
* ูุง ูุฌุจ ุงูุงุนุชูุงุฏ ุนูู ุจูุงูุงุช ุงูุฃุณุนุงุฑ ุฃู ุงููุจูุบ ูู